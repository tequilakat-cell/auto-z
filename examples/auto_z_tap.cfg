# Include this file (or copy sections into printer.cfg) and tune values for your machine.
#
# Required section for persistence.
[save_variables]
filename: ~/printer_data/config/variables.cfg

# Main plugin section.
[auto_z_tap]
# Object name that exposes start_probe_session()/run_probe() in Klipper.
probe_object: probe

# Where to sample the bed. Use a point representative of your first layer area.
reference_xy_position: 150, 150

# Safety and probe repeatability settings.
auto_home: True
home_command: G28
clear_bed_mesh_before_probe: True
safe_z: 10
probe_start_z: 8
travel_speed: 200
probe_samples: 5
probe_samples_result: median
max_probe_spread: 0.020
probe_retries: 2
sample_retract_dist: 1.5
max_drift: 1.0
calibration_z_hop: 5.0

# Require [save_variables] for reproducible state.
require_save_variables: True
variable_prefix: auto_z_tap

# Global adjustment layer (applies every run).
global_offset: 0.000
bed_temp_coeff: 0.00000
hotend_temp_coeff: 0.00000
chamber_temp_coeff: 0.00000
first_layer_coeff: 0.00000
first_layer_reference: 0.20

# If not set, references fallback to calibration-time temperatures.
# bed_temp_reference: 60
# hotend_temp_reference: 210
# chamber_temp_reference: 35

# Automatic profile selection and runtime behavior.
default_profile: pei
chamber_sensor: temperature_sensor chamber
max_total_adjustment: 0.600
apply_move: False
persist_last_run: True
report_breakdown: True

# Example profile: smooth PEI sheet specific compensation.
[auto_z_tap_adjustment pei]
priority: 10
build_surface: pei
offset: 0.000
bed_temp_coeff: 0.00015
hotend_temp_coeff: 0.00005

# Example profile: textured PEI tends to need a little more squish.
[auto_z_tap_adjustment textured]
priority: 20
build_surface: textured
offset: -0.015

# Example profile: PLA material stack.
[auto_z_tap_adjustment pla]
priority: 30
material: pla
offset: 0.000
bed_temp_coeff: 0.00008
hotend_temp_coeff: 0.00003
first_layer_coeff: -0.25000
first_layer_reference: 0.20

# Example profile: PETG material stack.
[auto_z_tap_adjustment petg]
priority: 40
material: petg
offset: 0.010
bed_temp_coeff: 0.00010
hotend_temp_coeff: 0.00002
first_layer_coeff: -0.20000
first_layer_reference: 0.24
